<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ØºÙ†ÙŠÙ„ÙŠ - Ø¥Ù‡Ø¯Ø§Ø¡Ø§Øª</title>
    
    <link href="https://fonts.googleapis.com/css2?family=Aref+Ruqaa:wght@700&family=Cairo:wght@400;700&display=swap" rel="stylesheet">
    
    <style>
        :root {
            --bg-dark: #0f1016;
            --card-bg: #1a1b26;
            --pink-accent: #f83292;
            --text-gray: #8a8b9c;
            --gold: #d4af37;
            --gradient-active: linear-gradient(to right, #9133a8, #f83292);
            --gradient-dim: linear-gradient(to right, rgba(145, 51, 168, 0.1), rgba(248, 50, 146, 0.1));
        }

        body, html {
            background-color: var(--bg-dark);
            color: white;
            font-family: 'Cairo', sans-serif;
            margin: 0; padding: 0;
            overflow-x: hidden;
            height: 100%;
        }

        /* Ù†Ø¸Ø§Ù… Ø§Ù„Ù‚Ù„ÙˆØ¨ Ø§Ù„Ù…ØªØ­Ø±ÙƒØ© */
        .heart-fly {
            position: fixed;
            color: var(--pink-accent);
            font-size: 20px;
            pointer-events: none;
            z-index: 999;
            animation: moveUp 4s linear forwards;
        }

        @keyframes moveUp {
            0% { transform: translateY(100vh) rotate(0deg); opacity: 1; }
            100% { transform: translateY(-10vh) rotate(360deg); opacity: 0; }
        }

        .app-container {
            width: 100%; max-width: 420px;
            margin: auto; padding: 20px;
            min-height: 100vh;
            display: flex; flex-direction: column;
        }

        .header-logo { text-align: center; font-size: 40px; color: var(--gold); margin: 20px 0; font-weight: bold; }

        .step-container {
            background-color: var(--card-bg);
            border-radius: 35px; padding: 25px;
            box-shadow: 0 20px 50px rgba(0,0,0,0.5);
            position: relative; z-index: 10;
        }

        .progress-dots { display: flex; justify-content: center; gap: 8px; margin-bottom: 25px; direction: ltr; }
        .dot { width: 12px; height: 6px; background: #3a3b4c; border-radius: 10px; transition: 0.3s; }
        .dot.active { background: var(--pink-accent); width: 25px; }

        /* Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø£ØºØ§Ù†ÙŠ */
        .song-card {
            background: #222332; border-radius: 20px; padding: 12px;
            display: flex; align-items: center; margin-bottom: 12px;
            cursor: pointer; border: 2px solid transparent; transition: 0.3s;
        }
        .song-card.selected { border-color: var(--pink-accent); background: rgba(248, 50, 146, 0.05); }
        .song-img { width: 60px; height: 60px; border-radius: 12px; margin-left: 15px; }

        /* Ø­Ù‚Ù„ Ø§Ù„Ø§Ø³Ù… ÙˆØ§Ù„Ø®Ø· Ø§Ù„Ø­Ø± */
        .input-section { display: none; margin-top: 30px; text-align: center; }
        .name-input {
            width: 100%; background: rgba(0,0,0,0.4); border: 2px solid var(--pink-accent);
            border-radius: 20px; padding: 15px; color: white;
            font-family: 'Aref Ruqaa', serif; font-size: 35px;
            text-align: center; outline: none; box-sizing: border-box;
        }

        .btn-main {
            width: 100%; border: none; padding: 18px; border-radius: 50px;
            color: rgba(255,255,255,0.2); font-size: 18px; font-weight: bold;
            margin-top: 25px; background: var(--gradient-dim); transition: 0.4s;
            cursor: pointer;
        }
        .btn-main.active { background: var(--gradient-active); color: white; opacity: 1; box-shadow: 0 5px 20px rgba(248, 50, 146, 0.4); }

        /* ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ù…Ø³ØªÙ„Ù… (Ø§Ù„ØªØ£Ø«ÙŠØ±Ø§Øª Ø§Ù„Ø³ÙŠÙ†Ù…Ø§Ø¦ÙŠØ©) */
        #view-screen { display: none; text-align: center; animation: fadeIn 1s; }
        .big-name {
            font-family: 'Aref Ruqaa', serif; font-size: 60px;
            background: linear-gradient(to bottom, #fff, var(--pink-accent));
            -webkit-background-clip: text; -webkit-text-fill-color: transparent;
            display: block; margin: 20px 0;
        }
        .lyrics-box { height: 50px; color: var(--gold); font-size: 18px; margin-top: 10px; font-weight: bold; }

        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
    </style>
</head>
<body>

<div class="app-container">
    <div class="header-logo" id="main-logo">ØºÙ†ÙŠÙ„ÙŠ</div>

    <div class="step-container">
        <div id="maker-ui">
            <div class="progress-dots">
                <div class="dot" id="dot3"></div><div class="dot" id="dot2"></div><div class="dot active" id="dot1"></div>
            </div>
            
            <div id="song-selection">
                <h3 style="text-align: center;">Ø§Ø®ØªØ± Ø£ØºÙ†ÙŠØªÙƒ</h3>
                <div class="song-card" onclick="selectSong(this, 'Ø®Ù„ÙŠÙƒ Ù…Ø¹Ø§ÙŠØ§', 'https://www.soundhelix.com/examples/mp3/SoundHelix-Song-1.mp3')">
                    <div style="flex-grow:1; text-align:right;"><strong>Ø®Ù„ÙŠÙƒ Ù…Ø¹Ø§ÙŠØ§</strong><br><small style="color:var(--text-gray)">Ø¹Ù…Ø±Ùˆ Ø¯ÙŠØ§Ø¨</small></div>
                    <img src="https://i.ibb.co/VWV0pY6/amr.jpg" class="song-img">
                </div>
                <div class="song-card" onclick="selectSong(this, 'Ø¨Ø§Ù‚Ø© ÙˆØ±Ø¯', 'https://www.soundhelix.com/examples/mp3/SoundHelix-Song-2.mp3')">
                    <div style="flex-grow:1; text-align:right;"><strong>ÙŠØ§ Ø¨Ø§Ù‚Ø© ÙˆØ±Ø¯ Ø§Ù†Øª</strong><br><small style="color:var(--text-gray)">Ù…Ø­Ù…Ø¯ Ø¹Ø¨Ø¯ Ø§Ù„Ø¬Ø¨Ø§Ø±</small></div>
                    <img src="https://i.ibb.co/6yXyX6m/artist.jpg" class="song-img">
                </div>
            </div>

            <div class="input-section" id="nameArea">
                <h3>Ø§ÙƒØªØ¨ Ø§Ù„Ø§Ø³Ù… âœï¸</h3>
                <input type="text" id="nameField" class="name-input" placeholder="Ø­Ù„ÙˆØªÙŠ" oninput="validate()">
            </div>

            <button id="nextBtn" class="btn-main" onclick="generate()" disabled>Ø§Ø³ØªÙ…Ø±Ø§Ø± â†</button>
        </div>

        <div id="view-screen">
            <div style="font-size: 60px;">ğŸ’–</div>
            <p style="color:var(--text-gray)">Ø±Ø³Ø§Ù„Ø© Ø­Ø¨ Ø®Ø§ØµØ© Ø¥Ù„Ù‰</p>
            <span id="targetName" class="big-name"></span>
            <div class="lyrics-box" id="lyrics">Ø§Ø¶ØºØ· Ù„Ù„Ø¨Ø¯Ø¡...</div>
            <button class="btn-main active" id="playBtn" onclick="startExperience()">Ø´ØºÙ‘Ù„ Ø§Ù„Ø¥Ù‡Ø¯Ø§Ø¡ ğŸµ</button>
            <p style="margin-top: 50px; font-size: 12px; color: var(--text-gray);">ØªØµÙ…ÙŠÙ… ÙˆØ¨Ø±Ù…Ø¬Ø© Ø­Ø³ÙŠÙ† Ø¹Ù„ÙŠ</p>
        </div>

        <div id="success-ui" style="display:none; text-align:center;">
            <h3 style="color:#4caf50">âœ… ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø±Ø§Ø¨Ø·!</h3>
            <div id="finalLink" style="background:#000; padding:15px; border-radius:15px; font-size:12px; word-break:break-all; margin:20px 0; border:1px solid var(--pink-accent);"></div>
            <button class="btn-main active" onclick="copyAction()">Ù†Ø³Ø® Ø§Ù„Ø±Ø§Ø¨Ø·</button>
        </div>
    </div>
</div>

<audio id="bgMusic"></audio>

<script>
    let song = "";
    let musicUrl = "";

    // Ø§Ù„ØªØ£ÙƒØ¯ Ù…Ù† ØªØ´ØºÙŠÙ„ Ø§Ù„Ø±Ø§Ø¨Ø· Ø¨Ø´ÙƒÙ„ ØµØ­ÙŠØ­
    window.onload = function() {
        const params = new URLSearchParams(window.location.search);
        if (params.has('to')) {
            document.getElementById('maker-ui').style.display = 'none';
            document.getElementById('main-logo').style.display = 'none';
            document.getElementById('view-screen').style.display = 'block';
            document.getElementById('targetName').innerText = decodeURIComponent(params.get('to'));
            musicUrl = decodeURIComponent(params.get('m'));
            // ØªØ´ØºÙŠÙ„ Ø§Ù„Ù‚Ù„ÙˆØ¨
            setInterval(createHeart, 300);
        }
    };

    function createHeart() {
        const h = document.createElement('div');
        h.innerHTML = "â¤ï¸";
        h.className = 'heart-fly';
        h.style.left = Math.random() * 100 + "vw";
        h.style.animationDuration = (Math.random() * 2 + 2) + "s";
        document.body.appendChild(h);
        setTimeout(() => h.remove(), 4000);
    }

    function selectSong(el, name, url) {
        document.querySelectorAll('.song-card').forEach(c => c.classList.remove('selected'));
        el.classList.add('selected');
        song = name; musicUrl = url;
        document.getElementById('nameArea').style.display = 'block';
        document.getElementById('dot1').classList.remove('active');
        document.getElementById('dot2').classList.add('active');
        validate();
    }

    function validate() {
        const val = document.getElementById('nameField').value.trim();
        const btn = document.getElementById('nextBtn');
        if(val.length > 0 && song) { btn.classList.add('active'); btn.disabled = false; }
        else { btn.classList.remove('active'); btn.disabled = true; }
    }

    function generate() {
        const name = document.getElementById('nameField').value;
        const currentLink = window.location.origin + window.location.pathname;
        const finalUrl = currentLink + "?to=" + encodeURIComponent(name) + "&m=" + encodeURIComponent(musicUrl);
        
        document.getElementById('maker-ui').style.display = 'none';
        document.getElementById('success-ui').style.display = 'block';
        document.getElementById('finalLink').innerText = finalUrl;
        document.getElementById('dot2').classList.remove('active');
        document.getElementById('dot3').classList.add('active');
    }

    function copyAction() {
        const link = document.getElementById('finalLink').innerText;
        const tempInput = document.createElement('input');
        document.body.appendChild(tempInput);
        tempInput.value = link;
        tempInput.select();
        document.execCommand('copy');
        document.body.removeChild(tempInput);
        alert("ØªÙ… Ù†Ø³Ø® Ø§Ù„Ø±Ø§Ø¨Ø·! Ø£Ø±Ø³Ù„Ù‡ Ù„Ù…Ù† ØªØ­Ø¨.");
    }

    function startExperience() {
        const player = document.getElementById('bgMusic');
        player.src = musicUrl;
        player.play();
        document.getElementById('playBtn').style.display = 'none';
        
        const lyrics = ["Ø£Ù†ØªÙ ÙƒÙ„ Ø¹Ù…Ø±ÙŠ...", "ÙŠØ§ Ø¨Ø§Ù‚Ø© ÙˆØ±Ø¯ Ø§Ù†ØªÙ...", "Ø£Ø­Ø¨ÙƒÙ Ù„Ù„Ø£Ø¨Ø¯ ğŸ’–"];
        let i = 0;
        setInterval(() => {
            document.getElementById('lyrics').innerText = lyrics[i % lyrics.length];
            i++;
            createHeart(); // Ø²ÙŠØ§Ø¯Ø© Ø§Ù„Ù‚Ù„ÙˆØ¨ Ù…Ø¹ Ø§Ù„Ù…ÙˆØ³ÙŠÙ‚Ù‰
        }, 3000);
    }
</script>
</body>
</html>
